<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Summer Snack Party! ‚òÄÔ∏è</title>
  <style>
    :root {
      --bg: #fff9c4;
      --sky: #2196f3;
      --pink: #f06292;
      --green: #4caf50;
      --orange: #ff9800;
    }

    html, body {
      overflow-x: hidden;
      overflow-y: auto; 
      min-height: 100vh;
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      -webkit-overflow-scrolling: touch;
    }

    body {
      background-color: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 10px 80px 10px; 
      padding-top: calc(env(safe-area-inset-top) + 20px); 
      box-sizing: border-box;
    }

    h2 { 
      color: #d32f2f; 
      margin: 10px 0 20px 0; 
      font-size: 2rem; 
      text-shadow: 1px 1px 0px white;
      text-align: center;
    }

    #clue-board {
      width: 90%; max-width: 450px;
      background: white; border: 3px solid var(--orange);
      border-radius: 15px; padding: 15px; margin-bottom: 25px;
      box-shadow: 0 4px 0 #e65100;
    }

    .clue-item { font-size: 16px; font-weight: bold; color: #5d4037; margin-bottom: 6px; }

    .grid {
      display: grid; 
      grid-template-columns: repeat(2, 1fr);
      gap: 20px; 
      margin-bottom: 30px;
      width: 100%;
      max-width: 500px;
    }

    .target-box {
      background: white; padding: 15px; border-radius: 20px;
      display: flex; flex-direction: column; align-items: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .char-tag {
      font-size: 14px; font-weight: 800; color: white;
      padding: 6px 15px; border-radius: 12px; margin-bottom: 12px;
      width: 90%; text-align: center;
    }

    .anu { background: var(--pink); }
    .bala { background: var(--sky); }
    .chitra { background: #9c27b0; }
    .deepak { background: var(--green); }

    .target {
      width: 100px; height: 100px;
      border: 3px dashed #ccc; border-radius: 15px;
      display: flex; justify-content: center; align-items: center;
      background: #fafafa;
      transition: background 0.2s;
    }

    .target.drag-over { background: #fff59d; border-color: var(--orange); border-style: solid; }

    #tray {
      width: 90%; max-width: 450px; min-height: 100px;
      background: white; border: 4px solid var(--sky);
      border-radius: 25px; display: flex;
      justify-content: space-evenly; align-items: center;
      padding: 15px; box-shadow: 0 6px 0 #1565c0;
    }

    .snack {
      display: flex; flex-direction: column; align-items: center;
      cursor: grab; user-select: none; width: 80px;
      touch-action: none; 
      transition: transform 0.1s;
    }

    .snack:hover { transform: scale(1.1); }
    .snack:active { cursor: grabbing; }

    .snack-emoji { font-size: 42px; line-height: 1; }

    .snack-label {
      font-size: 11px; font-weight: bold; color: #333;
      margin-top: 4px; text-align: center;
    }

    .dragging {
      position: fixed !important;
      pointer-events: none;
      z-index: 1000;
      transform: scale(1.3) !important;
    }

    #check-btn {
      margin-top: 40px; padding: 18px 70px;
      background: #4caf50; color: white;
      border: none; border-radius: 50px;
      font-size: 24px; font-weight: bold;
      box-shadow: 0 6px 0 #2e7d32; cursor: pointer;
      transition: all 0.2s;
    }

    #check-btn:active {
      transform: translateY(4px);
      box-shadow: 0 2px 0 #2e7d32;
    }

    #overlay {
      position: fixed; inset: 0; background: rgba(255,255,255,0.96);
      display: flex; flex-direction: column; align-items: center;
      justify-content: center; z-index: 2000;
    }
    .hidden { display: none !important; }
  </style>
</head>
<body>

  <h2>Summer Snack Party! üçâ</h2>

  <div id="clue-board">
    <div class="clue-item">ü¶Å Anu: Not mango or ice cream</div>
    <div class="clue-item">ü¶Å Bala: Cold but not fruit</div>
    <div class="clue-item">ü¶Å Chitra: The snack is yellow</div>
    <div class="clue-item">ü¶Å Deepak: Fresh Lemon Juice</div>
  </div>

  <div class="grid">
    <div class="target-box">
      <div class="char-tag anu">üë© Anu</div>
      <div class="target" data-ans="üçâ"></div>
    </div>
    <div class="target-box">
      <div class="char-tag bala">üë¶ Bala</div>
      <div class="target" data-ans="üç¶"></div>
    </div>
    <div class="target-box">
      <div class="char-tag chitra">üëß Chitra</div>
      <div class="target" data-ans="ü•≠"></div>
    </div>
    <div class="target-box">
      <div class="char-tag deepak">üë¶ Deepak</div>
      <div class="target" data-ans="üçπ"></div>
    </div>
  </div>

  <div id="tray">
    <div class="snack" data-val="üçâ">
      <span class="snack-emoji">üçâ</span>
      <span class="snack-label">Watermelon</span>
    </div>
    <div class="snack" data-val="üç¶">
      <span class="snack-emoji">üç¶</span>
      <span class="snack-label">Ice Cream</span>
    </div>
    <div class="snack" data-val="üçπ">
      <span class="snack-emoji">üçπ</span>
      <span class="snack-label">Lemon Juice</span>
    </div>
    <div class="snack" data-val="ü•≠">
      <span class="snack-emoji">ü•≠</span>
      <span class="snack-label">Mango</span>
    </div>
  </div>

  <button id="check-btn" onclick="check()">CHECK! ‚úÖ</button>

  <div id="overlay" class="hidden">
    <h1 id="msg" style="text-align:center;"></h1>
    <button onclick="location.reload()" style="padding:15px 40px; background:var(--sky); color:white; border:none; border-radius:30px; font-weight:bold; cursor:pointer;">PLAY AGAIN üîÑ</button>
  </div>

      <a href="{{ url_for('index') }}" 
   style="position: absolute; top: 10px; left: 10px; z-index: 1001; 
          text-decoration: none; background: white; padding: 5px 15px; 
          border-radius: 20px; border: 2px solid #ff6b6b; font-weight: bold; 
          color: #ff6b6b; font-size: 0.8rem;">
    üè† Try More!
</a>
  <script>
    let activeItem = null;

    function onStart(e) {
      activeItem = e.target.closest('.snack');
      if (!activeItem) return;

      const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
      const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

      activeItem.classList.add('dragging');
      moveAt(clientX, clientY);
    }

    function onMove(e) {
      if (!activeItem) return;

      if (e.cancelable) e.preventDefault();

      const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
      const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

      moveAt(clientX, clientY);

      const hit = document.elementFromPoint(clientX, clientY)?.closest('.target');
      document.querySelectorAll('.target').forEach(t => t.classList.remove('drag-over'));
      if (hit) hit.classList.add('drag-over');
    }

    function onEnd(e) {
      if (!activeItem) return;

      const clientX = e.type.includes('mouse') ? e.clientX : e.changedTouches[0].clientX;
      const clientY = e.type.includes('mouse') ? e.clientY : e.changedTouches[0].clientY;

      activeItem.classList.remove('dragging');

      activeItem.style.display = 'none'; 
      const dropZone = document.elementFromPoint(clientX, clientY)?.closest('.target, #tray');
      activeItem.style.display = 'flex';
      activeItem.style.position = 'static';

      if (dropZone && dropZone.id !== 'tray') {
        const old = dropZone.querySelector('.snack');
        if (old) document.getElementById('tray').appendChild(old);
        dropZone.appendChild(activeItem);
      } else {
        document.getElementById('tray').appendChild(activeItem);
      }

      document.querySelectorAll('.target').forEach(t => t.classList.remove('drag-over'));
      activeItem = null;
    }

    function moveAt(x, y) {
      activeItem.style.left = (x - (activeItem.offsetWidth / 2)) + 'px';
      activeItem.style.top = (y - (activeItem.offsetHeight / 2)) + 'px';
    }

    // Attach listeners
    document.querySelectorAll('.snack').forEach(s => {
      s.addEventListener('mousedown', onStart);
      s.addEventListener('touchstart', onStart, {passive: false});
    });

    document.addEventListener('mousemove', onMove);
    document.addEventListener('touchmove', onMove, {passive: false});
    document.addEventListener('mouseup', onEnd);
    document.addEventListener('touchend', onEnd);

    function check() {
      let score = 0;
      const targets = document.querySelectorAll('.target');
      targets.forEach(t => {
        const snack = t.querySelector('.snack');
        if (snack && snack.dataset.val === t.dataset.ans) score++;
      });
      
      const overlay = document.getElementById('overlay');
      const msg = document.getElementById('msg');
      overlay.classList.remove('hidden');
      
      if (score === targets.length) {
        msg.innerHTML = "ü•≥ YAY!<br>Everyone has the right snack!";
        msg.style.color = "#4caf50";
      } else {
        msg.innerHTML = "üßê Hmm...<br>Someone has the wrong snack.<br>Check the clues!";
        msg.style.color = "#f06292";
      }
    }
  </script>
</body>
</html>